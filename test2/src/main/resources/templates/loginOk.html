<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>남기정_로그인완료_회원정보페이징</title>
    <link href="/css/loginOk.css" rel="stylesheet" type="text/css" />
</head>
<body>
<!--<h1> 로그인 성공 </h1>-->
<div id="userResults">
    <table>
        <tr>
            <th> ID </th>
            <th> PWD </th>
            <th> NAME </th>
            <th> LEVEL </th>
            <th> DESC </th>
            <th> REG_DATE </th>
        </tr>
        <tr th:if="${#lists.isEmpty(userPagingResultDTO.userDTOList)}">
            <td colspan="6">회원 정보가 없습니다.</td>
        </tr>
        <tr th:each="userDTO : ${userPagingResultDTO.userDTOList}" th:if="${!#lists.isEmpty(userPagingResultDTO.userDTOList)}">
            <td th:text="${userDTO.id}"></td>
            <td th:text="${userDTO.pwd}"></td>
            <td th:text="${userDTO.name}"></td>
            <td th:text="${userDTO.level}"></td>
            <td name="desc" th:data-name="${userDTO.desc}"></td>
            <td name="regDate" th:data-name="${userDTO.regDate}"></td>
        </tr>
    </table>
</div>

<div id="pagingArea">
    <th:block th:if="${userPagingResultDTO.buttonBlockDTO.previousBlock}">
        <button id="previous" name="pagingButton"><</button>
    </th:block>
    <th:block th:each="i : ${#numbers.sequence(userPagingResultDTO.buttonBlockDTO.currentBlockFirstNumber, userPagingResultDTO.buttonBlockDTO.currentBlockLastNumber)}">
        <button name="pagingButton" th:data-name="${i}" th:text="${i}"></button>
    </th:block>
    <th:block th:if="${userPagingResultDTO.buttonBlockDTO.nextBlock}">
        <button id="next" name="pagingButton">></button>
    </th:block>
</div>

</body>
<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
<script src="/js/utility.js"></script>
<script>
    // DOM이 완전히 로드되고 파싱 완료된 시점에 실행
    document.addEventListener('DOMContentLoaded', function() {
        console.log('DOM 준비 완료!');

        let regDates = document.getElementsByName("regDate");
        for (regDate of regDates){
            let originalRegDate = regDate.dataset.name;
            console.log("originalRegDate : "+originalRegDate);

            console.log("type originalRegDate : "+ typeof(originalRegDate));
            let completeRegDate = makeLocalDateTimeToString(originalRegDate);
            regDate.textContent = completeRegDate;
        }

        let descs = document.getElementsByName("desc");
        for (desc of descs){
            let descText = desc.dataset.name;
            console.log("descText : "+descText);
            console.log("type descText : "+typeof(descText));

            if(descText === undefined){
                desc.textContent = "";
            }
            else{
                desc.textContent = descText;
            }
        }

        //페이징 버튼 이벤트 걸기
        let buttons = document.getElementsByName("pagingButton");
        for(button of buttons){
            button.addEventListener('click', function(e){
                handleButtonsNumber(e);
            });
        }

        //페이징 버튼 번호들 처리
        function handleButtonsNumber(e){
            //현재 있는 몇번째 페이지 정보 가져오기
            let clickedNumber = e.target.dataset.name;

        }

    });
</script>
</html>